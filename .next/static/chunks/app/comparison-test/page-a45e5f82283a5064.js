(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[138],{2254:function(e,a,s){Promise.resolve().then(s.bind(s,8197))},8197:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return n}});var t=s(7437),r=s(2265);let l=[3,7,10,14];class i{calculateSpreadDelta(e,a){return e-a}checkKeyNumberCrossing(e,a){let s=[];for(let t of l)(e>t&&a<t||e<t&&a>t)&&s.push(t),(e>-t&&a<-t||e<-t&&a>-t)&&s.push(-t);return{crosses:s.length>0,numbers:s}}checkFavoriteFlip(e,a){return e>0&&a<0||e<0&&a>0}detectLeague(e,a){for(let s of["Cardinals","Falcons","Ravens","Bills","Panthers","Bears","Bengals","Browns","Cowboys","Broncos","Lions","Packers","Texans","Colts","Jaguars","Chiefs","Raiders","Chargers","Rams","Dolphins","Vikings","Patriots","Saints","Giants","Jets","Eagles","Steelers","49ers","Seahawks","Buccaneers","Titans","Commanders","Washington"])if(e.includes(s)||a.includes(s))return"NFL";for(let s of["State","University","College","Tech","A&M","Central","Eastern","Western","Northern","Southern","Carolina","Florida","Georgia","Alabama","Auburn","Tennessee","Kentucky","Virginia","Michigan","Ohio","Penn","Texas","Oklahoma","Kansas","Iowa","UCLA","USC","Stanford","California","Oregon","Washington","Arizona","Colorado","Utah","Nevada","Hawaii","Louisiana","Mississippi","Arkansas","Missouri","Illinois","Indiana","Wisconsin","Minnesota","Nebraska","Purdue","Northwestern","Rutgers","Maryland","Boston","Syracuse","Pittsburgh","Duke","Wake Forest","NC State","Clemson","Miami","FSU","UCF","USF","Temple","Navy","Army","Air Force","Notre Dame","BYU","TCU","Baylor","SMU","Houston","Rice","Tulane","Memphis","Vanderbilt","Ole Miss","LSU"])if(e.includes(s)||a.includes(s))break;return"NCAAF"}compareGame(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,t=this.calculateSpreadDelta(e.spread,a.homeSpread),r=this.checkKeyNumberCrossing(e.spread,a.homeSpread),l=this.checkFavoriteFlip(e.spread,a.homeSpread),i=a.league||this.detectLeague(a.homeTeam,a.awayTeam);return{gameId:a.gameId,homeTeam:a.homeTeam,awayTeam:a.awayTeam,gameTime:a.gameTime,league:i,picksheetSpread:e.spread,marketSpread:a.homeSpread,spreadDelta:t,crossesKeyNumber:r.crosses,keyNumbersCrossed:r.numbers,favoriteFlipped:l,confidence:s,matched:!0}}compareGames(e,a,s){let t=[],r=new Set(e.map((e,a)=>a)),l=new Set(a.map((e,a)=>a));for(let i of s){let s=e[i.picksheetIndex],n=a[i.marketIndex];s&&n&&(t.push(this.compareGame(s,n,i.confidence)),r.delete(i.picksheetIndex),l.delete(i.marketIndex))}let i=[];for(let a of Array.from(r)){let s=e[a];i.push({source:"picksheet",gameInfo:"".concat(s.awayTeam," @ ").concat(s.homeTeam," (").concat(s.spread,")"),reason:"No matching market game found",gameTime:s.gameTime})}for(let e of Array.from(l)){let s=a[e];i.push({source:"market",gameInfo:"".concat(s.awayTeam," @ ").concat(s.homeTeam," (").concat(s.homeSpread,")"),reason:"No matching picksheet game found",gameTime:s.gameTime})}let n=this.calculateKPIs(t,e.length,i.filter(e=>"picksheet"===e.source).length);return{comparisons:t,kpis:n,unmatched:i}}calculateKPIs(e,a,s){let t=e.length;if(0===t)return{totalGames:a,matchedGames:0,unmatchedGames:s,matchRate:0,avgSpreadDelta:0,medianSpreadDelta:0,p95SpreadDelta:0,stdDevSpreadDelta:0,keyNumberCrossings:0,keyNumberCrossingRate:0,favoriteFlips:0,favoriteFlipRate:0,largestDelta:null,timestamp:new Date().toISOString()};let r=e.map(e=>Math.abs(e.spreadDelta)),l=r.reduce((e,a)=>e+a,0)/r.length,i=[...r].sort((e,a)=>e-a),n=i[Math.floor(i.length/2)],d=Math.floor(.95*i.length),c=i[Math.min(d,i.length-1)],o=r.reduce((e,a)=>e+Math.pow(a-l,2),0)/r.length,m=e.filter(e=>e.crossesKeyNumber).length,x=e.filter(e=>e.favoriteFlipped).length,h=null;if(e.length>0){let a=e.reduce((e,a)=>Math.abs(a.spreadDelta)>Math.abs(e.spreadDelta)?a:e);h={gameId:a.gameId,teams:"".concat(a.awayTeam," @ ").concat(a.homeTeam),delta:a.spreadDelta}}return{totalGames:a,matchedGames:t,unmatchedGames:s,matchRate:t/a,avgSpreadDelta:Number(l.toFixed(2)),medianSpreadDelta:Number(n.toFixed(2)),p95SpreadDelta:Number(c.toFixed(2)),stdDevSpreadDelta:Number(Math.sqrt(o).toFixed(2)),keyNumberCrossings:m,keyNumberCrossingRate:Number((m/t).toFixed(3)),favoriteFlips:x,favoriteFlipRate:Number((x/t).toFixed(3)),largestDelta:h,timestamp:new Date().toISOString()}}static formatSpread(e,a){return 0===a?"".concat(e," PK"):"".concat(e," ").concat(a>0?"+":"").concat(a)}static getRiskLevel(e){let a=Math.abs(e);return a<=2?"low":a<=4?"medium":a<=7?"high":"critical"}static getRiskColor(e){switch(e){case"low":return"text-green-600";case"medium":return"text-yellow-600";case"high":return"text-orange-600";case"critical":return"text-red-600";default:return"text-gray-600"}}}function n(){let[e,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(""),[n,d]=(0,r.useState)(null),[c,o]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),h=(e,a)=>e.trim().split("\n").filter(e=>e.trim()).map(e=>{let s=e.lastIndexOf("@");if(-1===s)return null;let t=e.substring(0,s).trim(),r=e.substring(s+1).trim(),l=r.match(/([+-]?\d+\.?\d*)$/);if(!l)return null;let i=parseFloat(l[0]),n=r.substring(0,r.lastIndexOf(l[0])).trim();return a?{awayTeam:t,homeTeam:n,spread:i}:{gameId:"".concat(t,"-").concat(n).toLowerCase().replace(/\s+/g,"-"),awayTeam:t,homeTeam:n,homeSpread:i,gameTime:new Date().toISOString()}}).filter(Boolean),p=async()=>{o(!0);try{let a=h(e,!0),t=m?null:h(s,!1),r=await fetch("/api/compare",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({picksheetGames:a,marketGames:t,useOddsAPI:m})}),l=await r.json();l.success&&d({comparisons:l.comparisons,kpis:l.kpis,unmatched:l.unmatched})}catch(e){console.error("Error running comparison:",e)}finally{o(!1)}},g=e=>{let a=i.getRiskLevel(e);return i.getRiskColor(a)};return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\uD83D\uDCCA Spread Comparison & KPI Calculator"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Compare picksheet spreads against market odds and calculate key performance indicators"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Picksheet Games"}),(0,t.jsx)("textarea",{value:e,onChange:e=>a(e.target.value),className:"w-full h-48 p-3 border rounded-lg font-mono text-sm",placeholder:"Format: Away Team @ Home Team +/-Spread"}),(0,t.jsx)("button",{onClick:()=>a("Dallas Cowboys @ Philadelphia Eagles -3\nKansas City Chiefs @ LA Chargers +7.5\nTampa Bay Buccaneers @ Atlanta Falcons -2.5\n#11 Alabama @ Michigan State +14\nOhio State @ Tennessee -7\nNew England Patriots @ Buffalo Bills -9.5"),className:"mt-2 px-3 py-1 text-sm bg-gray-600 text-white rounded hover:bg-gray-700",children:"Load Sample"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Market Odds",(0,t.jsxs)("label",{className:"ml-4 text-sm font-normal",children:[(0,t.jsx)("input",{type:"checkbox",checked:m,onChange:e=>x(e.target.checked),className:"mr-2"}),"Use Live Odds API"]})]}),(0,t.jsx)("textarea",{value:s,onChange:e=>l(e.target.value),className:"w-full h-48 p-3 border rounded-lg font-mono text-sm",placeholder:"Format: Away Team @ Home Team +/-Spread",disabled:m}),(0,t.jsx)("button",{onClick:()=>l("Philadelphia Eagles @ Dallas Cowboys -3.5\nLA Chargers @ Kansas City Chiefs +6.5\nAtlanta Falcons @ Tampa Bay Buccaneers -3\nMichigan State @ Alabama +13.5\nTennessee @ Ohio State -6.5\nBuffalo Bills @ New England Patriots -10"),className:"mt-2 px-3 py-1 text-sm bg-gray-600 text-white rounded hover:bg-gray-700",disabled:m,children:"Load Sample"})]})]}),(0,t.jsx)("div",{className:"flex justify-center mb-6",children:(0,t.jsx)("button",{onClick:p,disabled:c||!e||!s&&!m,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:c?"Comparing...":"Compare Spreads"})}),(null==n?void 0:n.kpis)&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDCC8 Key Performance Indicators"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Match Rate"}),(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[(100*n.kpis.matchRate).toFixed(1),"%"]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[n.kpis.matchedGames,"/",n.kpis.totalGames," games"]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Avg Spread Delta"}),(0,t.jsx)("div",{className:"text-2xl font-bold ".concat(g(n.kpis.avgSpreadDelta)),children:n.kpis.avgSpreadDelta}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["σ = ",n.kpis.stdDevSpreadDelta]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Median Delta"}),(0,t.jsx)("div",{className:"text-2xl font-bold ".concat(g(n.kpis.medianSpreadDelta)),children:n.kpis.medianSpreadDelta}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["P95: ",n.kpis.p95SpreadDelta]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Key # Crossings"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:n.kpis.keyNumberCrossings}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[(100*n.kpis.keyNumberCrossingRate).toFixed(1),"% rate"]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Favorite Flips"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:n.kpis.favoriteFlips}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[(100*n.kpis.favoriteFlipRate).toFixed(1),"% rate"]})]}),n.kpis.largestDelta&&(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded md:col-span-3",children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Largest Delta"}),(0,t.jsxs)("div",{className:"text-lg font-bold ".concat(g(n.kpis.largestDelta.delta)),children:[n.kpis.largestDelta.delta," points"]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:n.kpis.largestDelta.teams})]})]})]}),(null==n?void 0:n.comparisons)&&n.comparisons.length>0&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"\uD83C\uDFC8 Game Comparisons"})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Game"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Picksheet"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Market"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Delta"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Flags"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Confidence"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200",children:n.comparisons.map((e,a)=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsxs)("td",{className:"px-4 py-2 text-sm",children:[(0,t.jsx)("div",{children:e.awayTeam}),(0,t.jsxs)("div",{className:"text-gray-500",children:["@ ",e.homeTeam]})]}),(0,t.jsxs)("td",{className:"px-4 py-2 text-sm font-mono",children:[e.picksheetSpread>0?"+":"",e.picksheetSpread]}),(0,t.jsxs)("td",{className:"px-4 py-2 text-sm font-mono",children:[e.marketSpread>0?"+":"",e.marketSpread]}),(0,t.jsxs)("td",{className:"px-4 py-2 text-sm font-bold ".concat(g(e.spreadDelta)),children:[e.spreadDelta>0?"+":"",e.spreadDelta.toFixed(1)]}),(0,t.jsx)("td",{className:"px-4 py-2 text-sm",children:(0,t.jsxs)("div",{className:"flex gap-1",children:[e.crossesKeyNumber&&(0,t.jsxs)("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded",children:["Key #",e.keyNumbersCrossed.join(", ")]}),e.favoriteFlipped&&(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded",children:"Fav Flip"})]})}),(0,t.jsx)("td",{className:"px-4 py-2 text-sm",children:(0,t.jsxs)("div",{className:"font-mono ".concat(e.confidence>=.9?"text-green-600":e.confidence>=.7?"text-yellow-600":"text-red-600"),children:[(100*e.confidence).toFixed(0),"%"]})})]},a))})]})})]}),(null==n?void 0:n.unmatched)&&n.unmatched.length>0&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"⚠️ Unmatched Games"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)("div",{className:"space-y-2",children:n.unmatched.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-start gap-2 text-sm",children:[(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat("picksheet"===e.source?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:e.source}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.gameInfo}),(0,t.jsx)("div",{className:"text-gray-500",children:e.reason})]})]},a))})})]})]})})}new i}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2254)}),_N_E=e.O()}]);